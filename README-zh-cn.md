# GhTr DIY JSON 助手

## 目录

1. [简介](#简介)
2. [功能](#功能)
3. [安装](#安装)
4. [使用方法](#使用方法)
    - [使用命令](#使用命令)
    - [使用键盘快捷键](#使用键盘快捷键)
5. [详细功能描述](#详细功能描述)
    - [1. 插入僵尸](#1-插入僵尸)
    - [2. 清除波次](#2-清除波次)
    - [3. 清除所有波次](#3-清除所有波次)
    - [4. 创建模板](#4-创建模板)
    - [5. 生成总结](#5-生成总结)
6. [示例](#示例)
7. [配置](#配置)
8. [贡献](#贡献)
9. [许可证](#许可证)
10. [鸣谢](#鸣谢)

## 简介

欢迎使用 **GhTr DIY JSON 助手**，这是一个强大的 Visual Studio Code (VS Code) 扩展，旨在简化为 **GhTr DIY** 游戏创建和管理基于 JSON 的关卡的过程。无论您是游戏开发者、设计师还是爱好者，此扩展都提供了一套工具，以提升您的工作流程，减少错误，并在处理关卡配置时提高生产力。

## 功能

GhTr DIY JSON 助手提供以下功能：

1. **插入僵尸**：轻松将僵尸添加到关卡文件的特定波次和行中。
2. **清除波次**：移除指定波次中的所有僵尸。
3. **清除所有波次**：一次性移除所有波次中的所有僵尸。
4. **创建模板**：根据可自定义参数生成新的关卡模板。
5. **生成总结**：创建关卡的综合总结，包括僵尸统计和波次信息。

此外，扩展还提供：

- **自动补全**：在输入时建议僵尸类型。
- **JSON 验证**：确保您的 JSON 文件符合正确的模式，突出显示语法错误和无效条目。
- **键盘快捷键**：使用预定义或可自定义的键盘快捷键快速访问所有功能。

## 安装

您可以直接从 VS Code Marketplace 安装 GhTr DIY JSON 助手，或使用 VS Code 扩展命令进行安装。

### 从 VS Code Marketplace

1. 打开 VS Code。
2. 通过点击侧边栏的 **扩展** 图标或按 `Ctrl+Shift+X` 导航到 **扩展** 视图。
3. 在搜索栏中输入 `GhTr DIY JSON Helper`。
4. 在搜索结果中找到该扩展并点击 **安装**。
5. 安装完成后，您可能需要重新加载 VS Code 以激活扩展。

### 使用命令行

1. 确保您已安装 [Node.js](https://nodejs.org/) 和 [npm](https://www.npmjs.com/)。
2. 打开终端或命令提示符。
3. 导航到您的 VS Code 扩展目录，通常位于：
    - **Windows**: `%USERPROFILE%\.vscode\extensions`
    - **macOS/Linux**: `~/.vscode/extensions`
4. 克隆或下载扩展仓库。
5. 进入扩展文件夹并运行：
    ```bash
    npm install
    npm run compile
    ```
6. 使用以下命令打包扩展：
    ```bash
    vsce package
    ```
7. 通过运行以下命令安装生成的 `.vsix` 文件：
    ```bash
    code --install-extension your-extension-name.vsix
    ```

## 使用方法

安装后，GhTr DIY JSON 助手将增强您在处理 GhTr DIY 关卡 JSON 文件时的工作流程。以下是入门指南：

### 使用命令

1. **打开关卡文件**：打开项目中的 `levels` 目录下的 JSON 文件（例如 `levels/level1.json`）。
2. **访问命令**：
    - 按 `Ctrl+Shift+P`（macOS 上为 `Cmd+Shift+P`）打开命令面板。
    - 输入 `GhTr DIY` 以筛选并查看可用命令。
    - 从列表中选择所需的命令。

### 使用键盘快捷键

为了更快速地访问，GhTr DIY JSON 助手提供了预定义的键盘快捷键：

- **插入僵尸**：`Ctrl+Alt+Z`
- **清除波次**：`Ctrl+Alt+C`
- **清除所有波次**：`Ctrl+Alt+Shift+C`
- **创建模板**：`Ctrl+Alt+T`
- **生成总结**：`Ctrl+Alt+S`

*注意*：您可以通过导航到 **文件 > 首选项 > 键盘快捷键** 并搜索相应的命令名称来自定义这些快捷键。

## 详细功能描述

### 1. 插入僵尸

**命令**: `ghtr-diy.insertZombie`  
**快捷键**: `Ctrl+Alt+Z`

**描述**：  
允许您将指定类型的僵尸添加到关卡文件中的特定波次和行。这确保了在设计关卡时的一致性和准确性。

**使用步骤**：

1. **触发命令**：
    - 使用快捷键 `Ctrl+Alt+Z` 或通过命令面板访问（`Ctrl+Shift+P` > `GhTr DIY: Insert Zombie`）。
2. **选择僵尸类型**：
    - 将出现一个下拉菜单，列出可用的僵尸类型：
        - `NORMALZOMBIE`
        - `FLAGZOMBIE`
        - `CONEZOMBIE`
        - `BUCKETZOMBIE`
        - `POLEZOMBIE`
        - `FIREFLYZOMBIE`
        - `ARROWZOMBIE`
        - `WITCHZOMBIE`
        - `INFROLLZOMBIE`
        - `MAGTRUCKZOMBIE`
        - `HAMSTERZOMBIE`
        - `NULLZOMBIE`
        - `ENDNULLZOMBIE`
    - 选择所需类型。
3. **输入波次数量**：
    - 输入要插入僵尸的波次数量（从 1 开始的整数）。
    - 例如：输入 `3` 将僵尸添加到第三波。
4. **输入行号**：
    - 输入行号（0 到 4，`-1` 表示随机，`-2` 表示最弱行）。
    - 例如：输入 `2` 将僵尸放置在第二行。
5. **确认**：
    - 插入成功后，将出现确认消息：  
      `已在第 3 波的第 2 行插入 NORMALZOMBIE。`

**注意事项**：

- 扩展确保波次之间的 `NULLZOMBIE` 分隔符保持不变。
- 如果指定的波次不存在，将自动创建。
- 行号有助于在波次中垂直组织僵尸。

### 2. 清除波次

**命令**: `ghtr-diy.clearWave`  
**快捷键**: `Ctrl+Alt+C`

**描述**：  
移除指定波次中的所有僵尸，让您可以重置或修改该波次而不影响其他波次。

**使用步骤**：

1. **触发命令**：
    - 使用快捷键 `Ctrl+Alt+C` 或通过命令面板访问（`Ctrl+Shift+P` > `GhTr DIY: Clear Wave`）。
2. **输入波次数量**：
    - 输入要清除的波次数量（从 1 开始的整数）。
    - 例如：输入 `2` 将清除第二波中的所有僵尸。
3. **确认**：
    - 清除成功后，将出现确认消息：  
      `已清空第 2 波的所有僵尸。`

**注意事项**：

- 此操作仅影响指定的波次，其他波次保持不变。
- 扩展保留 `NULLZOMBIE` 分隔符以确保 JSON 结构有效。

### 3. 清除所有波次

**命令**: `ghtr-diy.clearAllWaves`  
**快捷键**: `Ctrl+Alt+Shift+C`

**描述**：  
允许您一次性移除关卡文件中所有波次的所有僵尸，实质上重置关卡的僵尸配置。

**使用步骤**：

1. **触发命令**：
    - 使用快捷键 `Ctrl+Alt+Shift+C` 或通过命令面板访问（`Ctrl+Shift+P` > `GhTr DIY: Clear All Waves`）。
2. **确认提示**：
    - 将出现警告消息：  
      `确定要清空所有波数的所有僵尸吗？此操作不可撤销。`
    - 点击 **是** 继续或 **取消** 中止。
3. **确认**：
    - 清除成功后，将出现确认消息：  
      `已清空所有波数的所有僵尸。`

**注意事项**：

- 此操作不可逆，请确保在继续之前备份或确认。
- 仅会清除 `ZombieList`，其他关卡参数如 `Sun` 和 `Background` 保持不变。

### 4. 创建模板

**命令**: `ghtr-diy.createTemplate`  
**快捷键**: `Ctrl+Alt+T`

**描述**：  
根据用户指定的参数（如初始阳光数量、总波次数和背景 ID）生成新的关卡模板 JSON 文件。

**使用步骤**：

1. **触发命令**：
    - 使用快捷键 `Ctrl+Alt+T` 或通过命令面板访问（`Ctrl+Shift+P` > `GhTr DIY: Create Template`）。
2. **输入初始阳光数量**：
    - 输入起始阳光数量（整数）。
    - 例如：输入 `100` 表示初始阳光数量为 100。
3. **输入总波次数**：
    - 输入总波次数（整数）。
    - 例如：输入 `10` 表示十波。
4. **输入背景 ID**：
    - 输入背景 ID（整数），对应所需的背景。
    - 例如：输入 `3` 表示使用背景编号 3。
5. **选择保存位置**：
    - 将弹出一个对话框，提示您选择新模板 JSON 文件的保存位置。
    - 选择所需的目录和文件名（例如 `levels/new_level.json`）。
6. **确认**：
    - 创建成功后，将出现确认消息：  
      `DIY 模板示例文件已创建。`

**注意事项**：

- 生成的模板包括一个空的 `ZombieList`，您可以使用其他扩展功能填充僵尸。
- 确保保存位置位于项目的 `levels` 目录中，以便最佳组织。

### 5. 生成总结

**命令**: `ghtr-diy.generateSummary`  
**快捷键**: `Ctrl+Alt+S`

**描述**：  
分析当前关卡 JSON 文件并生成综合总结，包括僵尸统计、波次信息和整体关卡指标。总结将保存为 Markdown 文件，便于阅读和分享。

**使用步骤**：

1. **触发命令**：
    - 使用快捷键 `Ctrl+Alt+S` 或通过命令面板访问（`Ctrl+Shift+P` > `GhTr DIY: Generate Summary`）。
2. **处理关卡文件**：
    - 扩展将解析当前的 JSON 文件，分析 `ZombieList` 和其他参数。
3. **选择保存位置**：
    - 将弹出一个对话框，提示您选择总结 Markdown 文件的保存位置。
    - 选择所需的目录和文件名（例如 `levels/level1_summary.md`）。
4. **确认**：
    - 生成成功后，将出现确认消息：  
      `关卡总结已生成。`
5. **查看总结**：
    - 在 VS Code 中打开生成的 Markdown 文件以查看详细总结。

**生成的总结包括**：

- **初始阳光数量**：关卡的起始阳光数量。
- **背景 ID**：关卡使用的背景。
- **总波次数**：关卡中的波次数量。
- **节奏**：根据波次数量分类为缓慢、中等或快速。
- **僵尸强度**：根据僵尸总数分类为低、中或高。
- **僵尸表格**：每个波次和行中的详细僵尸列表。
- **僵尸统计**：关卡中使用的每种僵尸类型的数量。

**注意事项**：

- 总结采用 Markdown 格式，便于阅读和分享。
- 适用于文档编制、关卡审查或协作开发。

### 6. 格式化Json

**命令**: `ghtr-diy.formatJson`  
**快捷键**: `Ctrl+Alt+F`

**描述**：  
分析当前关卡 JSON 文件并生成综合总结，包括僵尸统计、波次信息和整体关卡指标。总结将保存为 Markdown 文件，便于阅读和分享。

**使用步骤**：

1. **触发命令**：
    - 使用快捷键 `Ctrl+Alt+F` 或通过命令面板访问（`Ctrl+Shift+P` > `GhTr DIY: Format JSON`）。
2. **处理关卡文件**：
    - 将当前Json文件格式化

## 示例

### 示例 1：插入僵尸

假设您想在第三波的第二行添加一个 `CONEZOMBIE`。

1. 打开您的关卡文件（例如 `levels/level1.json`）。
2. 按 `Ctrl+Alt+Z` 触发 **插入僵尸** 命令。
3. 从下拉菜单中选择 `CONEZOMBIE`。
4. 输入 `3` 作为波次数量。
5. 输入 `2` 作为行号。
6. 将出现确认消息：  
   `已在第 3 波的第 2 行插入 CONEZOMBIE。`

### 示例 2：清除特定波次

要清除第二波中的所有僵尸：

1. 打开您的关卡文件。
2. 按 `Ctrl+Alt+C` 触发 **清除波次** 命令。
3. 输入 `2` 作为波次数量。
4. 将出现确认消息：  
   `已清空第 2 波的所有僵尸。`

### 示例 3：创建新模板

要创建一个具有 150 初始阳光、12 波次和背景 ID 4 的新关卡模板：

1. 按 `Ctrl+Alt+T` 触发 **创建模板** 命令。
2. 输入 `150` 作为初始阳光数量。
3. 输入 `12` 作为总波次数量。
4. 输入 `4` 作为背景 ID。
5. 选择保存位置和文件名（例如 `levels/level_new.json`）。
6. 将出现确认消息：  
   `DIY 模板示例文件已创建。`

### 示例 4：生成总结

要为当前关卡文件生成总结：

1. 打开您的关卡文件。
2. 按 `Ctrl+Alt+S` 触发 **生成总结** 命令。
3. 选择保存位置和文件名（例如 `levels/level1_summary.md`）。
4. 将出现确认消息：  
   `关卡总结已生成。`
5. 打开生成的 `level1_summary.md` 查看详细总结。

## 配置

GhTr DIY JSON 助手预配置了优化性能的默认设置。然而，您可以根据需要自定义某些方面以更好地适应您的工作流程。

### 自定义键盘快捷键

如果您希望更改默认的键盘快捷键：

1. 导航到 **文件 > 首选项 > 键盘快捷键**。
2. 搜索特定的命令名称，如 `GhTr DIY: Insert Zombie`。
3. 点击现有的快捷键或 `+` 图标以添加新的键绑定。
4. 按下所需的键组合并确认。

### JSON 模式验证

扩展根据预定义的模式验证您的关卡 JSON 文件以确保正确性。您可以通过修改扩展目录中的 `schemas/ghtr-diy-schema.json` 文件来自定义或扩展模式。

**注意**：修改模式时请谨慎，以防引入验证错误。

### 扩展设置

目前，扩展未向用户公开特定的设置。未来的更新可能包括可自定义的设置以增强灵活性。

## 贡献

欢迎贡献！无论您是报告错误、建议功能还是提交拉取请求，您的投入都将帮助改进 GhTr DIY JSON 助手。

### 如何贡献

1. **Fork 仓库**：点击仓库页面上的 **Fork** 按钮以创建您的副本。
2. **克隆您的 Fork**：
    ```bash
    git clone https://github.com/Xcating/ghtr-diy-json-helper.git
    ```
3. **导航到项目目录**：
    ```bash
    cd ghtr-diy-json-helper
    ```
4. **安装依赖项**：
    ```bash
    npm install
    ```
5. **进行更改**：
    - 实现您的功能或修复错误。
    - 确保您的代码符合项目的编码标准。
6. **编译扩展**：
    ```bash
    npm run compile
    ```
7. **测试您的更改**：
    - 在 VS Code 中打开项目。
    - 按 `F5` 启动新的扩展开发主机。
    - 彻底测试您的更改。
8. **提交并推送**：
    ```bash
    git add .
    git commit -m "描述您的更改"
    git push origin your-branch-name
    ```
9. **创建拉取请求**：
    - 导航到您在 GitHub 上的 Fork。
    - 点击 **New Pull Request**。
    - 提供清晰的更改描述并提交。

### 报告问题

如果您遇到任何问题或有改进建议：

1. 导航到仓库的 [Issues](https://github.com/Xcating/ghtr-diy-json-helper/issues) 部分。
2. 点击 **New Issue**。
3. 提供描述性的标题和详细描述，包括如果适用的重现步骤。
4. 提交问题。

## 许可证

本项目无许可。

## 鸣谢

- **Visual Studio Code**：使此扩展成为可能的可扩展代码编辑器。
- **OpenAI**：提供基础的 AI 技术支持。
- **GhTr DIY 社区**：持续的反馈和支持，帮助塑造此扩展的发展。

---

*祝您关卡设计愉快！*